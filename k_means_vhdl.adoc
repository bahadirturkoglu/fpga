=                            K_MEANS VHDL KODU +



[source,vhdl]
------------------------------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.NUMERIC_STD.ALL; 
use IEEE.STD_LOGIC_SIGNED.ALL; 

entity k_means is
generic(	length : integer :=8;
            x: integer:=1
						);

port  (
Clk : in std_logic
);
end k_means ;


architecture Behavioral of k_means is

---------------------------------------------------------------------------------------------
--                                      BÖLME İŞLEMİ
--yeni merkezin belirlenmesi için kullanılacak

function  divide  (a : UNSIGNED; b : UNSIGNED) return UNSIGNED is
    variable a1 : unsigned(a'length-1 downto 0):=a;
    variable b1 : unsigned(b'length-1 downto 0):=b;
    variable p1 : unsigned(b'length downto 0):= (others => '0');
    variable i : integer:=0;

        begin
            for i in 0 to b'length-1 loop
                p1(b'length-1 downto 1) := p1(b'length-2 downto 0);
                p1(0) := a1(a'length-1);
                a1(a'length-1 downto 1) := a1(a'length-2 downto 0);
                p1 := p1-b1;
                    if(p1(b'length-1) ='1') then
                        a1(0) :='0';
                        p1 := p1+b1;
                    else
                        a1(0) :='1';
                    end if;
           end loop;
        return a1;
end divide;

----------------------------------------------------------------------------------------------
signal i,y: integer := 0;

type durum is (UZAKLIK, YENI_MERKEZ);
signal yeni_durum : durum := UZAKLIK;

type ROM is array (0 to 1) of std_logic_vector(1 downto 0); 
type ROM_1 is array(0 to 1) of ROM;
signal data : ROM_1 :=(("01","01"), --IRIS-DATANIN OLCAĞI DİZİ
                        ("01","10"));
 
signal center_1 :  ROM :=("11","10"); -- MERKEZ_1
signal center_2 :  ROM :=("10","10"); -- MERKEZ_2
 


type kume is array (0 to 3) of integer ; --MERKEZLERİN KUMELERİ İNDİS TUTULACAK
signal kume_1,kume_2 : kume:=(others =>0);


begin


u1:process(clk)
 
variable s1,s2,s3,s4:std_logic_vector(1 downto 0):=(others =>'0');
variable z1,z2,z3,z4,x1,x2:std_logic_vector(3 downto 0):=(others =>'0');


	
begin
  --to check the rising edge of the clock signal
if(clk'event and clk='1') then 
                                
     case yeni_durum is
         when UZAKLIK =>  
     
            if(i<5)then
            i<=i+1;
            end if;
            
         -- YAPILAN UZAKLIK İŞLEMİ=((CENTER(0)-DATA(Y))**2)+((CENTER(1)-DATA(Y+1))**2 ) 
            if(i=1)then
            
                s1:=abs(center_1(0)-data(y)(0));
                s2:=abs(center_1(1)-data(y)(1));
                s3:=abs(center_2(0)-data(y)(0));  
                s4:=abs(center_2(1)-data(y)(1));                        
            end if;
            
            if(i=2)then
                z1:=s1*s1; 
                z2:=s2*s2;
                z3:=s3*s3; 
                z4:=s4*s4;                                          
            end if;
            
            if(i=3)then           
                x1:=z1+z2; 
                x2:=z3+z4; 
            end if;
            
            if(i=4)then
                if(x2(y)<=x1(y))then --NOKTANIN 2 MERKEZE UZAKLIGININ KARŞILAŞTIRILMASI               
                  kume_2(y)<=y; 
                  y<=y+1;
                  i<=0;
                    --ve noktanın indisinin uygun kümede tutulması
                 else
                  kume_1(y)<=y;
                  y<=y+1;
                  i<=0;
                  
                end if;
              end if;
         when others => NULL;     
	 
--tüm elemanların merkez noktalarına uzaklıgı bulunup uygun kumelere atıldıktan sonra
--yenı merkez adında fonk oluşturulcak ve merkez guncellenecek ,güncellenen merkezler ile döngü tekrarlancak
-- merkezler stabil duruma  gelince program bitmiş olcak
--Deneme için 1 nokta ve 2 merkez kullanıyoruz daha sonra kod generic ifadesinin kullanımıyla dinamik hale getirilcek
--cıkarma işlemi olduktan sonra kare alma işlemine geçildiğinde sıradaki sayıların çıkarma işlemine 
--girmesi için pipeline yapmaya çalısıyoruz.  

   end case;                           
               
end if;
end process;


end Behavioral;


------------------------------------------------------------------------------------------------------------------




